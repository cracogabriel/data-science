def split_multi(val):
    """Divide campo multivalor em lista de tokens normalizados, suportando listas de dicionários."""
    if pd.isna(val):
        return []
    s = str(val).strip()
    if s.lower() in ("desconhecido", "none", "null", "", "nan"):
        return []

    # --- Caso seja lista de dicionários (ex: "[{'id': '1', 'description': 'action'}]") ---
    if s.startswith("[{") and s.endswith("}]"):
        try:
            fixed = (
                s.replace("'", '"')
                 .replace("False", "false")
                 .replace("True", "true")
            )
            data = json.loads(fixed)
            if isinstance(data, list):
                # se contiver 'description', extrair só isso
                tokens = []
                for item in data:
                    if isinstance(item, dict):
                        if "description" in item:
                            tokens.append(item["description"].strip().lower())
                        else:
                            # fallback: pega o primeiro valor textual
                            for v in item.values():
                                if isinstance(v, str):
                                    tokens.append(v.strip().lower())
                                    break
                return tokens
        except Exception:
            pass

    # --- Caso seja dicionário único (ex: "{'windows': True, 'mac': False}") ---
    if s.startswith("{") and s.endswith("}"):
        try:
            fixed = s.replace("'", '"').replace("False", "false").replace("True", "true")
            obj = json.loads(fixed)
            if isinstance(obj, dict):
                toks = [k for k, v in obj.items() if bool(v)]
                return [_clean_token(t) for t in toks if _clean_token(t)]
        except Exception:
            pass

    # --- Caso genérico: separar por delimitadores comuns ---
    toks = re.split(DELIMS, s)
    return [_clean_token(t) for t in toks if _clean_token(t)]